<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="PluploadMvc : Integrating Plupload with ASP.NET MVC.">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>PluploadMvc</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/mwijnands/PluploadMvc">View on GitHub</a>

          <h1 id="project_title">PluploadMvc</h1>
          <h2 id="project_tagline">Integrating Plupload with ASP.NET MVC.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/mwijnands/PluploadMvc/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/mwijnands/PluploadMvc/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="pluploadmvc" class="anchor" href="#pluploadmvc"><span class="octicon octicon-link"></span></a>PluploadMvc</h1>

<p><code>PluploadMvc</code> contains server side components to make it easy to integrate <a href="http://plupload.com">Plupload</a> into your ASP.NET MVC application. It can be used to deeply integrate <a href="http://plupload.com">Plupload</a> to make it feel like you're using a normal file input field, but you can also just use it for the included <code>PluploadHandler</code> (also supporting <a href="http://plupload.com/docs/Chunking">chunked file uploads</a>) + <code>PluploadContext</code> to easily retrieve the uploaded files. </p>

<p><a href="https://ci.appveyor.com/project/mwijnands/pluploadmvc"><img src="http://img.shields.io/appveyor/ci/mwijnands/pluploadmvc.svg?style=flat" alt="Build status"></a> <a href="https://www.nuget.org/packages/XperiCode.PluploadMvc"><img src="http://img.shields.io/nuget/v/XperiCode.PluploadMvc.svg?style=flat" alt="NuGet version"></a></p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>The <code>PluploadMvc</code> package is available at <a href="https://www.nuget.org/packages/XperiCode.PluploadMvc">NuGet</a>. To install <code>PluploadMvc</code>, run the following command in the <a href="http://docs.nuget.org/docs/start-here/using-the-package-manager-console">Package Manager Console</a>:</p>

<blockquote>
<h3>
<a name="install-package-xpericodepluploadmvc" class="anchor" href="#install-package-xpericodepluploadmvc"><span class="octicon octicon-link"></span></a>Install-Package XperiCode.PluploadMvc</h3>
</blockquote>

<h2>
<a name="documentation" class="anchor" href="#documentation"><span class="octicon octicon-link"></span></a>Documentation</h2>

<p>I will start with some examples of using the various server side components separately, to eventually get to a full integration example. All examples are built off of the <a href="http://plupload.com/examples/core">Plupload Core API sample</a> from the Plupload website at <a href="http://plupload.com/examples/core">http://plupload.com/examples/core</a>.</p>

<h4>
<a name="pluploadhandler" class="anchor" href="#pluploadhandler"><span class="octicon octicon-link"></span></a>PluploadHandler</h4>

<p><code>PluploadMvc</code> includes an <code>HttpHandler</code> that can be used to handle uploaded files that are uploaded by <a href="http://plupload.com">Plupload</a>. It is added to the <code>Web.config</code> as <code>Plupload.axd</code> automatically when using NuGet to install the package.</p>

<pre><code>&lt;system.webServer&gt;
    &lt;handlers&gt;
        &lt;add name="PluploadHandler" path="Plupload.axd" verb="POST" type="XperiCode.PluploadMvc.PluploadHandler, XperiCode.PluploadMvc" /&gt;
    &lt;/handlers&gt;
&lt;/system.webServer&gt;
</code></pre>

<p>This <code>HttpHandler</code> can be used to handle file uploads from Plupload. To be able to retrieve the uploaded files later, <strong>you need to pass the HttpHandler a reference in the form of a Guid</strong> (this will soon be a string in v0.3.0 for more flexibility). So the url option passed to the plupload constructor should be something like this:</p>

<pre><code>var uploader = new plupload.Uploader({
    // ...
    url : "/plupload.axd?reference=13095a38-6841-4204-a2cc-61135d812436",
    // ...
});
</code></pre>

<p>The <code>PluploadHandler</code> will now handle the file uploads (it handles <a href="http://plupload.com/docs/Chunking">chunked uploads</a> as well as normal uploads), and saves the files to a temporary folder at <code>~/App_Data/PluploadMvc/13095a38-6841-4204-a2cc-61135d812436/</code>.</p>

<h4>
<a name="pluploadcontext" class="anchor" href="#pluploadcontext"><span class="octicon octicon-link"></span></a>PluploadContext</h4>

<p>To easily retrieve the uploaded files, you can use <code>PluploadContext</code>. You should not create this class yourself. Instead, get it off <code>HttpContextBase</code> by using the provided extension method <code>GetPluploadContext()</code>. For example, within a <code>Controller</code> you could use:</p>

<pre><code>using XperiCode.PluploadMvc;
// ...
var pluploadContext = HttpContext.GetPluploadContext();
</code></pre>

<p>After acquiring the <code>PluploadContext</code>, you can use the <code>GetFiles()</code> method to retrieve the files that were uploaded using the specific <code>reference</code>:</p>

<pre><code>var reference = Guid.Parse("13095a38-6841-4204-a2cc-61135d812436");
var uploadedFiles = pluploadContext.GetFiles(reference);
</code></pre>

<p><code>uploadedFiles</code> will now contain a list of <code>PluploadFile</code> objects (inheriting <code>HttpPostedFileBase</code>) for you to work with. When you're done with the files (for example, you saved them to a database), you can use the <code>DeleteFiles()</code> method to delete them from the temporary folder. If you don't, they will keep being returned when calling <code>GetFiles()</code> using the same reference.</p>

<pre><code>pluploadContext.DeleteFiles(reference);
</code></pre>

<p><code>PluploadContext</code> also has a static method <code>CleanupFiles()</code> you could use on application startup, to cleanup the temporary <code>~/App_Data/PluploadMvc/</code> folder. When using the <a href="https://www.nuget.org/packages/XperiCode.PluploadMvc">NuGet package</a> to install <code>PluploadMvc</code>, this is added to your application automatically by adding <code>PluploadMvcConfig.cs</code> to the <code>App_Start</code> folder and using <a href="https://www.nuget.org/packages/WebActivatorEx/2.0.0">WebActivatorEx</a> to execute it on application startup.</p>

<pre><code>using XperiCode.PluploadMvc;
// ...
PluploadContext.CleanupFiles();
</code></pre>

<h4>
<a name="pluploadmodelbinder" class="anchor" href="#pluploadmodelbinder"><span class="octicon octicon-link"></span></a>PluploadModelBinder</h4>

<p>Examples of a full integration using a ViewModel and ModelBinder are coming, and this can already be found in the <a href="https://github.com/mwijnands/PluploadMvc/tree/master/PluploadMvc.Sample">sample project on GitHub</a>.</p>

<h2>
<a name="unit-testing" class="anchor" href="#unit-testing"><span class="octicon octicon-link"></span></a>(Unit) testing</h2>

<p>When using <code>PluploadMvc</code>, you can still test your controllers. The <code>HttpContextBase</code> extension method <code>GetPluploadContext()</code> returns an <code>IPluploadContext</code>. To make this return a <code>Mock</code>, you can use the extension method <code>SetPluploadContext()</code> first to set your <code>Mock</code>, so that when <code>GetPluploadContext()</code> is called in the code under test, it will return your <code>Mock</code>. Examples of this can be found in the tests of this project on <a href="https://github.com/mwijnands/PluploadMvc">GitHub</a>.</p>

<h2>
<a name="release-notes" class="anchor" href="#release-notes"><span class="octicon octicon-link"></span></a>Release notes</h2>

<h4>
<a name="v020" class="anchor" href="#v020"><span class="octicon octicon-link"></span></a>v0.2.0</h4>

<ul>
<li>Added support for chunked uploads</li>
</ul>

<h4>
<a name="v011" class="anchor" href="#v011"><span class="octicon octicon-link"></span></a>v0.1.1</h4>

<ul>
<li>Changed Microsoft.AspNet.Mvc dependencies to 5.0.0 (5.2.0 was unnecessary)</li>
</ul>

<h4>
<a name="v010" class="anchor" href="#v010"><span class="octicon octicon-link"></span></a>v0.1.0</h4>

<ul>
<li>Initial release</li>
</ul>

<h2>
<a name="collaboration" class="anchor" href="#collaboration"><span class="octicon octicon-link"></span></a>Collaboration</h2>

<p>Please report issues if you find any. Pull requests are welcome for documentation and code.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">PluploadMvc maintained by <a href="https://github.com/mwijnands">mwijnands</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
